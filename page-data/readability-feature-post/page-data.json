{"componentChunkName":"component---src-templates-blog-post-js","path":"/readability-feature-post/","result":{"data":{"site":{"siteMetadata":{"title":"oasisbusiness"}},"markdownRemark":{"id":"99c73d7f-90cf-5ae7-8716-55a219b318a8","excerpt":"Gradle IntelliJ를 시작하고 gradle로 프로젝트를 생성하고 SpringBoot로 프로젝트 개발 환경을 바꿔주고.. 이것저것 개발 환경을 바꿀 때 마다 이게 뭐길래 이걸로 하는걸까?싶었고 그 첫 번째 관문에서 마주친 것이 바로 gradle…","html":"<h3>Gradle</h3>\n<p>IntelliJ를 시작하고 gradle로 프로젝트를 생성하고 SpringBoot로 프로젝트 개발 환경을 바꿔주고..</p>\n<p>이것저것 개발 환경을 바꿀 때 마다 이게 뭐길래 이걸로 하는걸까?싶었고</p>\n<p>그 첫 번째 관문에서 마주친 것이 바로 gradle.</p>\n<h2>멀티 모듈</h2>\n<p>다중 프로젝트로 구성된 서비스에서 각 서버들마다 <em>공통으로 존재하는 클래스들</em> 을 효율적으로 다뤄주는 것이 바로,\n<strong>Gradle Multi Module</strong> 방식입니다.</p>\n<p>각 서버에 동일한 클래스가 존재한다하여 그저 복사 붙여넣기에 의존하다가는 프로젝트의 규모가 커질경우\n감당하기 힘든 수정의 늪에 빠지게 될 수 있습니다.\n실수 또한 피할 수 없겠죠</p>\n<p>그래서 복사 붙여넣기로 모든 서버에 동일 클래스를 존재시키는 것이 아니라\n공통 클래스를 한 번만 생성하여 사용할 수 있도록 프로젝트를 구성합니다.</p>\n<p>즉, 공통 프로젝트를 <strong>모듈</strong>화하여 프로젝트 안에 갖고 있는 구조입니다.</p>\n<hr>\n<p>이 때 개발을 하고, 빌드를 할 때 만족해야하는 조건이 있습니다.</p>\n<ul>\n<li>개발시에는 즉각적으로 공통 프로젝트 코드 사용이 용이</li>\n<li>\n<p>빌드시에는 자동으로 공통 프로젝트를 포함하여 빌드 진행</p>\n<hr>\n</li>\n</ul>\n<h1></h1>\n<h2>멀티 모듈 설계</h2>\n<h3>구조</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 375px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5bc9674957e071578fd613bc930fabce/5ff7e/projServe.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.43243243243243%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdUlEQVQY03WRz0sCURDHR0OToqAg+hvWW3sLPEQd61KHTl0i6hLhyehknQyiKBMU6+DiYlIES65o7sFddNddFiHBxR9XCQIvXjIQgmnWgyDSwDyYeZ/58p334Ntc6/StLZQuFvZ9m35fo2FhQSqgKIpoWRaeB4Pb9+HwSbvdRkmS0DTNYR8AmHw+/9xqtTCbzWKtVsNms2lAl1u66/LLH6kjF3uYxBm9oqVUVS2Uy+Wspqrvp4GAt1QqMZVKRZRl+UXXdaFYLCZJcJZ6O1QrdP9mGIZMc2eAv6tgx9OxByINBMTxvAyFoNfrAc/ziySwQqJemxczmQnWTjqu4IaAV7/HEcpNAtNut5PWeSQnP5QDcjOgtb+q1epuvV63GeeYYOd6Dj5v56GPG0OnD/E4cBwHiUTCwbIsMAzjImeqoihIKyEJItVITgP0ZkDiU8TaPEQiEfg3aAjS6TREo1G7dAqCsJ7L5Q7oI/ZisRgzckShadpo7g8Bpgys+HTohAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"projServe\"\n        title=\"projServe\"\n        src=\"/static/5bc9674957e071578fd613bc930fabce/5ff7e/projServe.png\"\n        srcset=\"/static/5bc9674957e071578fd613bc930fabce/12f09/projServe.png 148w,\n/static/5bc9674957e071578fd613bc930fabce/e4a3f/projServe.png 295w,\n/static/5bc9674957e071578fd613bc930fabce/5ff7e/projServe.png 375w\"\n        sizes=\"(max-width: 375px) 100vw, 375px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>프로젝트 구조 예시</p>\n<ul>\n<li>사용자와 접하는 서버: WEB 프로젝트</li>\n<li>DB와 접하는 서버: API 프로젝트</li>\n<li>공통으로 사용할 프로젝트: COMMON 프로젝트</li>\n</ul>\n</li>\n</ul>\n<h1></h1>\n<p>root 프로젝트 하위에 각 프로젝트(모듈)를 생성합니다.</p>\n<blockquote>\n<p><strong>multi-modules</strong> / module-api, module-web, module-common</p>\n<blockquote>\n<p>module-common: 공통 프로젝트</p>\n</blockquote>\n</blockquote>\n<p>이 때 root 프로젝트를 기준으로 빌드가 이루어지기 때문에 하위 프로젝트에는\ngradle폴더나 redlew등의 파일이 없고 build.gradle과 src폴더만 존재한다는 점을 인지합니다.</p>\n<h1></h1>\n<hr>\n<h3>module-common</h3>\n<p>공통으로 사용 될 파일들을 생성합니다.</p>\n<p><strong>module-common/java/com/code/domain/Member.java</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">@Entity\npublic class Member {\n    @Id\n    @GeneratedValue\n    private Long id;\n\n    @Column\n    private String name;\n\n    @Column\n    private String email;\n\n    public Member() {\n    }\n\n    public Member(String name, String email) {\n        this.name = name;\n        this.email = email;\n    }\n\n    public Long getId() {\n        return id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public String getEmail() {\n        return email;\n    }\n}</code></pre></div>\n<h1></h1>\n<p><strong>module-common/java/com/code/repository/MemberRepository.java</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">public interface MemberRepository extends JpaRepository&lt;Member, Long&gt; {\n}</code></pre></div>\n<h1></h1>\n<p><strong>module-common/build.gradle</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dependencies {\n    compile(&#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;)\n    runtime(&#39;com.h2database:h2&#39;)\n    testCompile(&#39;org.springframework.boot:spring-boot-starter-test&#39;)\n}</code></pre></div>\n<p>작성한 Entity 클래스와 해당 Entity 의 repository, repository test를 위한 최소한의 의존성 추가</p>\n<h1></h1>\n<hr>\n<h3>module-api</h3>\n<p>module-common의 클래스들을 사용</p>\n<p><strong>module-api/java/MemberServiceCustom.java</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">@Service\npublic class MemberServiceCustom {\n\n    private MemberRepository memberRepository;\n\n    public MemberServiceCustom(MemberRepository memberRepository) {\n        this.memberRepository = memberRepository;\n    }\n\n    public Long signup (Member member) {\n        return memberRepository.save(member).getId();\n    }\n}</code></pre></div>\n<p>MemberRepository의 bean injection 사용</p>\n<h1></h1>\n<p><strong>module-api/build.gradle</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">dependencies {\n    compile(&#39;org.springframework.boot:spring-boot-starter-web&#39;)\n    testCompile(&#39;org.springframework.boot:spring-boot-starter-test&#39;)\n}</code></pre></div>\n<p>의존성 추가</p>\n<h1></h1>\n<hr>\n<h3>root 프로젝트의 settings.gradle</h3>\n<h4>module-api가 공통 프로젝트를 사용할 수 있고 spring boot 관련 의존성이 관리 되도록</h4>\n<h1></h1>\n<p><strong>multi-modules/settings.gradle</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">rootProject.name = &#39;multi-modules&#39;\n\ninclude &#39;module-common&#39;, &#39;module-api&#39;, &#39;module-web&#39;</code></pre></div>\n<p>multi-modules가 module-common, module-api-module-web을 관리한다는 정의</p>\n<h1></h1>\n<p><strong>multi-modules/gradle.build</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">buildscript {\n    ext {\n        springBootVersion = &#39;1.5.1.RELEASE&#39;\n    }\n    repositories {\n        mavenCentral()\n    }\n    dependencies {\n        classpath(&quot;org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}&quot;)\n        classpath &quot;io.spring.gradle:dependency-management-plugin:0.6.0.RELEASE&quot;\n    }\n}\n\nsubprojects {\n    group &#39;com.blogcode&#39;\n    version &#39;1.0&#39;\n\n    apply plugin: &#39;java&#39;\n    apply plugin: &#39;spring-boot&#39;\n    apply plugin: &#39;io.spring.dependency-management&#39;\n\n    sourceCompatibility = 1.8\n\n    repositories {\n        mavenCentral()\n    }\n\n    dependencies {\n        testCompile group: &#39;junit&#39;, name: &#39;junit&#39;, version: &#39;4.12&#39;\n    }\n}\n\nproject(&#39;:module-api&#39;) {\n    dependencies {\n        compile project(&#39;:module-common&#39;)\n    }\n}\n\nproject(&#39;:module-web&#39;) {\n    dependencies {\n        compile project(&#39;:module-common&#39;)\n    }\n}</code></pre></div>\n<p>subprojects와 project()</p>\n<h1></h1>\n<h3>subprojects</h3>\n<p>settings.gradle에서 정의해둔 하위 프로젝트들을 관리합니다.</p>\n<p>하위 프로젝트들의 의존성과 관련된 plugin을 등록합니다. ex)SpringBoot, Java</p>\n<p><em>root 프로젝트의 의존성까지 관리하고자 하면 allprojects로 관리합니다.</em></p>\n<h3>project</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">project(&#39;:하위 프로젝트 명&#39;) {\n  dependencies {\n    complie project(&#39;:의존하고있는 공통 프로젝트 명&#39;)\n    }\n  }</code></pre></div>\n<p><em>: 디렉토리 path 표시</em></p>\n<h3>👉🏻멀티 모듈 구조 완성!</h3>\n<h1></h1>\n<p>위에서 얘기했던 멀티 모듈 빌드시 만족 조건을 기억하시나요?</p>\n<blockquote>\n<p>빌드시에는 자동으로 공통 프로젝트를 포함하여 빌드 진행</p>\n</blockquote>\n<p>하지만 코드를 살펴보면 module-common에는 main메소드가 없기 때문에 프로젝트 빌드에 실패하게됩니다.</p>\n<blockquote>\n<p>단순한 참조용 클래스: jar형태로 만들 수 없음</p>\n</blockquote>\n<h3>gradle에서 제공하는 bootRepackage.enabled</h3>\n<p><strong>module-common/build.gradle에 추가</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">bootRepackage {\n    enabled = false\n}</code></pre></div>\n<h1></h1>\n<p><strong>스프링 부트 2.0 이상</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">bootJar { enabled = false }\njar { enabled = true }</code></pre></div>\n<h1></h1>\n<p>이로써 빌드까지 완벽히 가능한, 멀티 모듈 구조를 알아보고 함께 작성까지 해보았습니다!\n멀티 모듈 구조를 이용하려는 분들에게 유용한 자료가 됐길 바랍니다.</p>\n<p>감사합니다.</p>\n<h1></h1>\n<h1></h1>\n<hr>\n<h6>참조 사이트: 기억보단 기록을, “gradle 멀티모듈”, <a href=\"https://jojoldu.tistory.com/123\">https://jojoldu.tistory.com/123</a>, (2021.01.20)</h6>\n<h1></h1>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-2\">\n<p>멀티 모듈 빌드</p>\n<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a>\n</li>\n</ol>\n</div>","frontmatter":{"title":"Gradle? 멀티 모듈!","date":"January 20, 2021","description":"project with SpringBoot","writeAuthor":"semin","profile":"/semin.png"}}},"pageContext":{"slug":"/readability-feature-post/","previous":{"fields":{"slug":"/sample-post/"},"frontmatter":{"title":"ABOUT"}},"next":{"fields":{"slug":"/introduceGatsby/"},"frontmatter":{"title":"GATSBY: OUR BLOG"}}}},"staticQueryHashes":["1246554614","2841359383","4165419456"]}